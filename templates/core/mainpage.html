<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="first.css" rel="stylesheet">
    <title>HERspital</title>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=944c613fcf3d3b09b562ee8c5a116fd2"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=944c613fcf3d3b09b562ee8c5a116fd2&libraries=LIBRARY"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=944c613fcf3d3b09b562ee8c5a116fd2&libraries=services"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=944c613fcf3d3b09b562ee8c5a116fd2&libraries=services,clusterer,drawing"></script>
</head>
<body>
    {% block navbar %}
        {% include "partials/base.html" %}
    {% endblock%}
    
    <div id="home">

        <!-- 지도 -->
        <div id="map" style="width:65%;height:600px; display: block; margin: auto; border: 2px solid #FFC478; border-radius: 10px;"></div>
	    <script>
        		var container = document.getElementById('map');
		var options = {
			center: new kakao.maps.LatLng(33.450701, 126.570667),
			level: 3
		};

		var map = new kakao.maps.Map(container, options);

        if (navigator.geolocation) {
    
        // GeoLocation을 이용해서 접속 위치를 얻어옵니다
        navigator.geolocation.getCurrentPosition(function(position) {
        
        var lat = position.coords.latitude, // 위도
            lon = position.coords.longitude; // 경도
        
        var locPosition = new kakao.maps.LatLng(lat, lon), // 마커가 표시될 위치를 geolocation으로 얻어온 좌표로 생성합니다
            message = '<div style="padding:5px;">내 위치!</div>'; // 인포윈도우에 표시될 내용입니다
        
        // 마커와 인포윈도우를 표시합니다
        displayMarker(locPosition, message);
            
        });
    
        } else { // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다
    
        var locPosition = new kakao.maps.LatLng(33.450701, 126.570667),    
            message = 'geolocation을 사용할수 없어요..'
        
        displayMarker(locPosition, message);
        }

        // 지도에 마커와 인포윈도우를 표시하는 함수입니다
        function displayMarker(locPosition, message) {

        // 마커를 생성합니다
        var marker = new kakao.maps.Marker({  
            map: map, 
            position: locPosition
        }); 
    
        var iwContent = message, // 인포윈도우에 표시할 내용
            iwRemoveable = true;

        // 인포윈도우를 생성합니다
        var infowindow = new kakao.maps.InfoWindow({
            content : iwContent,
            removable : iwRemoveable
        });
    
        // 인포윈도우를 마커위에 표시합니다 
        infowindow.open(map, marker);
    
        // 지도 중심좌표를 접속위치로 변경합니다
        map.setCenter(locPosition);      
        } 

	    </script>

        <div id="content">
            <div id="info">
                <br><br><p style="text-align: center;" >{병원 정보 가져오기}</p><br><br>
                <hr style="border-color: rgba(190, 190, 190, 0.26); width: 73%;"><br>
            </div>

            <div id="review">
                <h2 style="text-align: center;">리뷰 ㅣ <span id="review-count">1</span>건</h2><br>
                <a class="review_star">별점 : </a> 
                <div class="star-rating space-x-4 mx-auto">
                    <input type="radio" id="5-stars" name="rating" value="5" v-model="ratings"/>
                    <label for="5-stars" class="star pr-4">★</label>
                    <input type="radio" id="4-stars" name="rating" value="4" v-model="ratings"/>
                    <label for="4-stars" class="star">★</label>
                    <input type="radio" id="3-stars" name="rating" value="3" v-model="ratings"/>
                    <label for="3-stars" class="star">★</label>
                    <input type="radio" id="2-stars" name="rating" value="2" v-model="ratings"/>
                    <label for="2-stars" class="star">★</label>
                    <input type="radio" id="1-star" name="rating" value="1" v-model="ratings"/>
                    <label for="1-star" class="star">★</label>
                </div>

                <div class="review-row">
                    <textarea id="new-review" name="new_review" rows="5" cols="170" placeholder="리뷰를 작성하세요. 단, 수정은 불가능합니다."></textarea><br>
                    <button type="submit" onclick="submitReview()" class="review_btn">등록</button><br>
                </div>
                <br><br>
                <div class="review-box">
                    <div class="review-row">
                        <div class="review-date" style="float: left;">익명<br>2021-08-03</div>
                        <div class="review-remove" style="font-size: 13px; margin-left: 1150px;"><a href="#">삭제</a></div>
                        <div class="review-content" style="padding-top: 40px;" >sample review<br><br></div><br>
                    </div>
                </div>
            </div>
        </div>
    </div>
        
<script type="text/javascript">

    // 별점 구현
    function ratingToPercent() {
        const score = +this.restaurant.averageScore * 20;
        return score + 1.5;
    }

    //리뷰 작성
    function warnEmpty(){
        alert("내용을 입력해주세요.");
    }
    function dateToString(date){
        const dateString = date.toISOString();
        const dateToString = dateString.substring(0,10);
        return dateToString;
    }
    function submitReview(){
        const newreviewEL = document.getElementById("new-review");
        const newreview = newreviewEL.value.trim();

        if(newreview){
            const dateEL = document.createElement('div');
            dateEL.classList.add('review-date');
            const dateString = dateToString(new Date());
            dateEL.innerText = dateString;

            const contentEL = document.createElement('div');
            contentEL.classList.add('review-content');
            contentEL.innerText = newreview;

            const br = document.createElement('div');
            br.innerHTML = "<br><hr><br><br>"

            const name = document.createElement('div');
            name.innerHTML = "익명 &emsp;"

            const br2 = document.createElement('div');
            br2.innerHTML = "<br><br>"

            const reviewEL = document.createElement('div');
            reviewEL.classList.add('review-row');
            reviewEL.appendChild(br);
            reviewEL.appendChild(name);
            reviewEL.appendChild(dateEL);
            reviewEL.appendChild(br2);
            reviewEL.appendChild(contentEL);
            reviewEL.appendChild(br2);

            document.getElementById('review').appendChild(reviewEL);
            newreviewEL.value = "";

            const countEL = document.getElementById('review-count');
            const count = countEL.innerText;
            countEL.innerText = parseInt(count) + 1;
        }else{
            warnEmpty();
        }
    }
    
   
</script>
</body>
</html>
{% block footer %}
    {% include "partials/footer.html" %}
{% endblock %}